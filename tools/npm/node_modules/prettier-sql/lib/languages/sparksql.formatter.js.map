{"version":3,"sources":["../../src/languages/sparksql.formatter.ts"],"names":["reservedFunctions","aggregate","window","array","map","datetime","json","misc","reservedKeywords","reservedCommands","reservedBinaryCommands","reservedDependentClauses","SparkSqlFormatter","Tokenizer","reservedLogicalOperators","stringTypes","blockStart","blockEnd","indexedPlaceholderTypes","namedPlaceholderTypes","lineCommentTypes","operators","token","isToken","WINDOW","tokenLookAhead","type","TokenType","BLOCK_START","RESERVED_KEYWORD","value","END","tokenLookBehind","WORD","test","Formatter","Object","values","reduce","acc","arr"],"mappings":"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","sourcesContent":["import Formatter from '../core/Formatter';\nimport Tokenizer from '../core/Tokenizer';\nimport { isToken, Token, TokenType } from '../core/token'; // convert to partial type import in TS 4.5\nimport type { StringPatternType } from '../core/regexFactory';\nimport { dedupe } from '../utils';\n\n/**\n * Priority 5 (last)\n * Full list of reserved functions\n * distinct from Keywords due to interaction with parentheses\n */\n// http://spark.apache.org/docs/latest/sql-ref-functions.html\nconst reservedFunctions = {\n\t// http://spark.apache.org/docs/latest/sql-ref-functions-builtin.html#aggregate-functions\n\taggregate: [\n\t\t'ANY',\n\t\t'APPROX_COUNT_DISTINCT',\n\t\t'APPROX_PERCENTILE',\n\t\t'AVG',\n\t\t'BIT_AND',\n\t\t'BIT_OR',\n\t\t'BIT_XOR',\n\t\t'BOOL_AND',\n\t\t'BOOL_OR',\n\t\t'COLLECT_LIST',\n\t\t'COLLECT_SET',\n\t\t'CORR',\n\t\t'COUNT',\n\t\t'COUNT',\n\t\t'COUNT',\n\t\t'COUNT_IF',\n\t\t'COUNT_MIN_SKETCH',\n\t\t'COVAR_POP',\n\t\t'COVAR_SAMP',\n\t\t'EVERY',\n\t\t'FIRST',\n\t\t'FIRST_VALUE',\n\t\t'GROUPING',\n\t\t'GROUPING_ID',\n\t\t'KURTOSIS',\n\t\t'LAST',\n\t\t'LAST_VALUE',\n\t\t'MAX',\n\t\t'MAX_BY',\n\t\t'MEAN',\n\t\t'MIN',\n\t\t'MIN_BY',\n\t\t'PERCENTILE',\n\t\t'PERCENTILE',\n\t\t'PERCENTILE_APPROX',\n\t\t'SKEWNESS',\n\t\t'SOME',\n\t\t'STD',\n\t\t'STDDEV',\n\t\t'STDDEV_POP',\n\t\t'STDDEV_SAMP',\n\t\t'SUM',\n\t\t'VAR_POP',\n\t\t'VAR_SAMP',\n\t\t'VARIANCE',\n\t],\n\t// http://spark.apache.org/docs/latest/sql-ref-functions-builtin.html#window-functions\n\twindow: [\n\t\t'CUME_DIST',\n\t\t'DENSE_RANK',\n\t\t'LAG',\n\t\t'LEAD',\n\t\t'NTH_VALUE',\n\t\t'NTILE',\n\t\t'PERCENT_RANK',\n\t\t'RANK',\n\t\t'ROW_NUMBER',\n\t],\n\t// http://spark.apache.org/docs/latest/sql-ref-functions-builtin.html#array-functions\n\tarray: [\n\t\t'ARRAY',\n\t\t'ARRAY_CONTAINS',\n\t\t'ARRAY_DISTINCT',\n\t\t'ARRAY_EXCEPT',\n\t\t'ARRAY_INTERSECT',\n\t\t'ARRAY_JOIN',\n\t\t'ARRAY_MAX',\n\t\t'ARRAY_MIN',\n\t\t'ARRAY_POSITION',\n\t\t'ARRAY_REMOVE',\n\t\t'ARRAY_REPEAT',\n\t\t'ARRAY_UNION',\n\t\t'ARRAYS_OVERLAP',\n\t\t'ARRAYS_ZIP',\n\t\t'FLATTEN',\n\t\t'SEQUENCE',\n\t\t'SHUFFLE',\n\t\t'SLICE',\n\t\t'SORT_ARRAY',\n\t],\n\t// http://spark.apache.org/docs/latest/sql-ref-functions-builtin.html#map-functions\n\tmap: [\n\t\t'ELEMENT_AT',\n\t\t'ELEMENT_AT',\n\t\t'MAP',\n\t\t'MAP_CONCAT',\n\t\t'MAP_ENTRIES',\n\t\t'MAP_FROM_ARRAYS',\n\t\t'MAP_FROM_ENTRIES',\n\t\t'MAP_KEYS',\n\t\t'MAP_VALUES',\n\t\t'STR_TO_MAP',\n\t],\n\t// http://spark.apache.org/docs/latest/sql-ref-functions-builtin.html#date-and-timestamp-functions\n\tdatetime: [\n\t\t'ADD_MONTHS',\n\t\t'CURRENT_DATE',\n\t\t'CURRENT_DATE',\n\t\t'CURRENT_TIMESTAMP',\n\t\t'CURRENT_TIMESTAMP',\n\t\t'CURRENT_TIMEZONE',\n\t\t'DATE_ADD',\n\t\t'DATE_FORMAT',\n\t\t'DATE_FROM_UNIX_DATE',\n\t\t'DATE_PART',\n\t\t'DATE_SUB',\n\t\t'DATE_TRUNC',\n\t\t'DATEDIFF',\n\t\t'DAY',\n\t\t'DAYOFMONTH',\n\t\t'DAYOFWEEK',\n\t\t'DAYOFYEAR',\n\t\t'EXTRACT',\n\t\t'FROM_UNIXTIME',\n\t\t'FROM_UTC_TIMESTAMP',\n\t\t'HOUR',\n\t\t'LAST_DAY',\n\t\t'MAKE_DATE',\n\t\t'MAKE_DT_INTERVAL',\n\t\t'MAKE_INTERVAL',\n\t\t'MAKE_TIMESTAMP',\n\t\t'MAKE_YM_INTERVAL',\n\t\t'MINUTE',\n\t\t'MONTH',\n\t\t'MONTHS_BETWEEN',\n\t\t'NEXT_DAY',\n\t\t'NOW',\n\t\t'QUARTER',\n\t\t'SECOND',\n\t\t'SESSION_WINDOW',\n\t\t'TIMESTAMP_MICROS',\n\t\t'TIMESTAMP_MILLIS',\n\t\t'TIMESTAMP_SECONDS',\n\t\t'TO_DATE',\n\t\t'TO_TIMESTAMP',\n\t\t'TO_UNIX_TIMESTAMP',\n\t\t'TO_UTC_TIMESTAMP',\n\t\t'TRUNC',\n\t\t'UNIX_DATE',\n\t\t'UNIX_MICROS',\n\t\t'UNIX_MILLIS',\n\t\t'UNIX_SECONDS',\n\t\t'UNIX_TIMESTAMP',\n\t\t'WEEKDAY',\n\t\t'WEEKOFYEAR',\n\t\t'WINDOW',\n\t\t'YEAR',\n\t],\n\t// http://spark.apache.org/docs/latest/sql-ref-functions-builtin.html#json-functions\n\tjson: [\n\t\t'FROM_JSON',\n\t\t'GET_JSON_OBJECT',\n\t\t'JSON_ARRAY_LENGTH',\n\t\t'JSON_OBJECT_KEYS',\n\t\t'JSON_TUPLE',\n\t\t'SCHEMA_OF_JSON',\n\t\t'TO_JSON',\n\t],\n\t// http://spark.apache.org/docs/latest/api/sql/index.html\n\tmisc: [\n\t\t'ABS',\n\t\t'ACOS',\n\t\t'ACOSH',\n\t\t'AGGREGATE',\n\t\t'ARRAY_SORT',\n\t\t'ASCII',\n\t\t'ASIN',\n\t\t'ASINH',\n\t\t'ASSERT_TRUE',\n\t\t'ATAN',\n\t\t'ATAN2',\n\t\t'ATANH',\n\t\t'BASE64',\n\t\t'BIGINT',\n\t\t'BIN',\n\t\t'BINARY',\n\t\t'BIT_COUNT',\n\t\t'BIT_GET',\n\t\t'BIT_LENGTH',\n\t\t'BOOLEAN',\n\t\t'BROUND',\n\t\t'BTRIM',\n\t\t'CARDINALITY',\n\t\t'CBRT',\n\t\t'CEIL',\n\t\t'CEILING',\n\t\t'CHAR',\n\t\t'CHAR_LENGTH',\n\t\t'CHARACTER_LENGTH',\n\t\t'CHR',\n\t\t'CONCAT',\n\t\t'CONCAT_WS',\n\t\t'CONV',\n\t\t'COS',\n\t\t'COSH',\n\t\t'COT',\n\t\t'CRC32',\n\t\t'CURRENT_CATALOG',\n\t\t'CURRENT_DATABASE',\n\t\t'CURRENT_USER',\n\t\t'DATE',\n\t\t'DECIMAL',\n\t\t'DEGREES',\n\t\t'DOUBLE',\n\t\t// 'E',\n\t\t'ELT',\n\t\t'EXP',\n\t\t'EXPM1',\n\t\t'FACTORIAL',\n\t\t'FIND_IN_SET',\n\t\t'FLOAT',\n\t\t'FLOOR',\n\t\t'FORALL',\n\t\t'FORMAT_NUMBER',\n\t\t'FORMAT_STRING',\n\t\t'FROM_CSV',\n\t\t'GETBIT',\n\t\t'HASH',\n\t\t'HEX',\n\t\t'HYPOT',\n\t\t'INITCAP',\n\t\t'INLINE',\n\t\t'INLINE_OUTER',\n\t\t'INPUT_FILE_BLOCK_LENGTH',\n\t\t'INPUT_FILE_BLOCK_START',\n\t\t'INPUT_FILE_NAME',\n\t\t'INSTR',\n\t\t'INT',\n\t\t'ISNAN',\n\t\t'ISNOTNULL',\n\t\t'ISNULL',\n\t\t'JAVA_METHOD',\n\t\t'LCASE',\n\t\t'LEFT',\n\t\t'LENGTH',\n\t\t'LEVENSHTEIN',\n\t\t'LN',\n\t\t'LOCATE',\n\t\t'LOG',\n\t\t'LOG10',\n\t\t'LOG1P',\n\t\t'LOG2',\n\t\t'LOWER',\n\t\t'LPAD',\n\t\t'LTRIM',\n\t\t'MAP_FILTER',\n\t\t'MAP_ZIP_WITH',\n\t\t'MD5',\n\t\t'MOD',\n\t\t'MONOTONICALLY_INCREASING_ID',\n\t\t'NAMED_STRUCT',\n\t\t'NANVL',\n\t\t'NEGATIVE',\n\t\t'NVL',\n\t\t'NVL2',\n\t\t'OCTET_LENGTH',\n\t\t'OVERLAY',\n\t\t'PARSE_URL',\n\t\t'PI',\n\t\t'PMOD',\n\t\t'POSEXPLODE',\n\t\t'POSEXPLODE_OUTER',\n\t\t'POSITION',\n\t\t'POSITIVE',\n\t\t'POW',\n\t\t'POWER',\n\t\t'PRINTF',\n\t\t'RADIANS',\n\t\t'RAISE_ERROR',\n\t\t'RAND',\n\t\t'RANDN',\n\t\t'RANDOM',\n\t\t'REFLECT',\n\t\t'REGEXP_EXTRACT',\n\t\t'REGEXP_EXTRACT_ALL',\n\t\t'REGEXP_LIKE',\n\t\t'REGEXP_REPLACE',\n\t\t'REPEAT',\n\t\t'REPLACE',\n\t\t'REVERSE',\n\t\t'RIGHT',\n\t\t'RINT',\n\t\t'ROUND',\n\t\t'RPAD',\n\t\t'RTRIM',\n\t\t'SCHEMA_OF_CSV',\n\t\t'SENTENCES',\n\t\t'SHA',\n\t\t'SHA1',\n\t\t'SHA2',\n\t\t'SHIFTLEFT',\n\t\t'SHIFTRIGHT',\n\t\t'SHIFTRIGHTUNSIGNED',\n\t\t'SIGN',\n\t\t'SIGNUM',\n\t\t'SIN',\n\t\t'SINH',\n\t\t'SMALLINT',\n\t\t'SOUNDEX',\n\t\t'SPACE',\n\t\t'SPARK_PARTITION_ID',\n\t\t'SPLIT',\n\t\t'SQRT',\n\t\t'STACK',\n\t\t'SUBSTR',\n\t\t'SUBSTRING',\n\t\t'SUBSTRING_INDEX',\n\t\t'TAN',\n\t\t'TANH',\n\t\t'TIMESTAMP',\n\t\t'TINYINT',\n\t\t'TO_CSV',\n\t\t'TRANSFORM_KEYS',\n\t\t'TRANSFORM_VALUES',\n\t\t'TRANSLATE',\n\t\t'TRIM',\n\t\t'TRY_ADD',\n\t\t'TRY_DIVIDE',\n\t\t'TYPEOF',\n\t\t'UCASE',\n\t\t'UNBASE64',\n\t\t'UNHEX',\n\t\t'UPPER',\n\t\t'UUID',\n\t\t'VERSION',\n\t\t'WIDTH_BUCKET',\n\t\t'XPATH',\n\t\t'XPATH_BOOLEAN',\n\t\t'XPATH_DOUBLE',\n\t\t'XPATH_FLOAT',\n\t\t'XPATH_INT',\n\t\t'XPATH_LONG',\n\t\t'XPATH_NUMBER',\n\t\t'XPATH_SHORT',\n\t\t'XPATH_STRING',\n\t\t'XXHASH64',\n\t\t'ZIP_WITH',\n\t],\n};\n\n/**\n * Priority 5 (last)\n * Full list of reserved words\n * any words that are in a higher priority are removed\n */\n// https://deepkb.com/CO_000013/en/kb/IMPORT-fbfa59f0-2bf1-31fe-bb7b-0f9efe9932c6/spark-sql-keywords\nconst reservedKeywords = [\n\t'ADD',\n\t'AFTER',\n\t'ALL',\n\t'ALTER',\n\t'ANALYZE',\n\t'AND',\n\t'ANTI',\n\t'ANY',\n\t'ARCHIVE',\n\t'ARRAY',\n\t'AS',\n\t'ASC',\n\t'AT',\n\t'AUTHORIZATION',\n\t'BETWEEN',\n\t'BOTH',\n\t'BUCKET',\n\t'BUCKETS',\n\t'BY',\n\t'CACHE',\n\t'CASCADE',\n\t'CAST',\n\t'CHANGE',\n\t'CHECK',\n\t'CLEAR',\n\t'CLUSTER',\n\t'CLUSTERED',\n\t'CODEGEN',\n\t'COLLATE',\n\t'COLLECTION',\n\t'COLUMN',\n\t'COLUMNS',\n\t'COMMENT',\n\t'COMMIT',\n\t'COMPACT',\n\t'COMPACTIONS',\n\t'COMPUTE',\n\t'CONCATENATE',\n\t'CONSTRAINT',\n\t'COST',\n\t'CREATE',\n\t'CROSS',\n\t'CUBE',\n\t'CURRENT',\n\t'CURRENT_DATE',\n\t'CURRENT_TIME',\n\t'CURRENT_TIMESTAMP',\n\t'CURRENT_USER',\n\t'DATA',\n\t'DATABASE',\n\t'DATABASES',\n\t'DAY',\n\t'DBPROPERTIES',\n\t'DEFINED',\n\t'DELETE',\n\t'DELIMITED',\n\t'DESC',\n\t'DESCRIBE',\n\t'DFS',\n\t'DIRECTORIES',\n\t'DIRECTORY',\n\t'DISTINCT',\n\t'DISTRIBUTE',\n\t'DIV',\n\t'DROP',\n\t'ESCAPE',\n\t'ESCAPED',\n\t'EXCEPT',\n\t'EXCHANGE',\n\t'EXISTS',\n\t'EXPORT',\n\t'EXTENDED',\n\t'EXTERNAL',\n\t'EXTRACT',\n\t'FALSE',\n\t'FETCH',\n\t'FIELDS',\n\t'FILTER',\n\t'FILEFORMAT',\n\t'FIRST',\n\t'FIRST_VALUE',\n\t'FOLLOWING',\n\t'FOR',\n\t'FOREIGN',\n\t'FORMAT',\n\t'FORMATTED',\n\t'FULL',\n\t'FUNCTION',\n\t'FUNCTIONS',\n\t'GLOBAL',\n\t'GRANT',\n\t'GROUP',\n\t'GROUPING',\n\t'HOUR',\n\t'IF',\n\t'IGNORE',\n\t'IMPORT',\n\t'IN',\n\t'INDEX',\n\t'INDEXES',\n\t'INNER',\n\t'INPATH',\n\t'INPUTFORMAT',\n\t'INTERSECT',\n\t'INTERVAL',\n\t'INTO',\n\t'IS',\n\t'ITEMS',\n\t'KEYS',\n\t'LAST',\n\t'LAST_VALUE',\n\t'LATERAL',\n\t'LAZY',\n\t'LEADING',\n\t'LEFT',\n\t'LIKE',\n\t'LINES',\n\t'LIST',\n\t'LOCAL',\n\t'LOCATION',\n\t'LOCK',\n\t'LOCKS',\n\t'LOGICAL',\n\t'MACRO',\n\t'MAP',\n\t'MATCHED',\n\t'MERGE',\n\t'MINUTE',\n\t'MONTH',\n\t'MSCK',\n\t'NAMESPACE',\n\t'NAMESPACES',\n\t'NATURAL',\n\t'NO',\n\t'NOT',\n\t'NULL',\n\t'NULLS',\n\t'OF',\n\t'ONLY',\n\t'OPTION',\n\t'OPTIONS',\n\t'OR',\n\t'ORDER',\n\t'OUT',\n\t'OUTER',\n\t'OUTPUTFORMAT',\n\t'OVER',\n\t'OVERLAPS',\n\t'OVERLAY',\n\t'OVERWRITE',\n\t'OWNER',\n\t'PARTITION',\n\t'PARTITIONED',\n\t'PARTITIONS',\n\t'PERCENT',\n\t'PLACING',\n\t'POSITION',\n\t'PRECEDING',\n\t'PRIMARY',\n\t'PRINCIPALS',\n\t'PROPERTIES',\n\t'PURGE',\n\t'QUERY',\n\t'RANGE',\n\t'RECORDREADER',\n\t'RECORDWRITER',\n\t'RECOVER',\n\t'REDUCE',\n\t'REFERENCES',\n\t'RENAME',\n\t'REPAIR',\n\t'REPLACE',\n\t'RESPECT',\n\t'RESTRICT',\n\t'REVOKE',\n\t'RIGHT',\n\t'RLIKE',\n\t'ROLE',\n\t'ROLES',\n\t'ROLLBACK',\n\t'ROLLUP',\n\t'ROW',\n\t'ROWS',\n\t'SCHEMA',\n\t'SECOND',\n\t'SELECT',\n\t'SEMI',\n\t'SEPARATED',\n\t'SERDE',\n\t'SERDEPROPERTIES',\n\t'SESSION_USER',\n\t'SETS',\n\t'SHOW',\n\t'SKEWED',\n\t'SOME',\n\t'SORT',\n\t'SORTED',\n\t'START',\n\t'STATISTICS',\n\t'STORED',\n\t'STRATIFY',\n\t'STRUCT',\n\t'SUBSTR',\n\t'SUBSTRING',\n\t'TABLE',\n\t'TABLES',\n\t'TBLPROPERTIES',\n\t'TEMPORARY',\n\t'TERMINATED',\n\t'TO',\n\t'TOUCH',\n\t'TRAILING',\n\t'TRANSACTION',\n\t'TRANSACTIONS',\n\t'TRIM',\n\t'TRUE',\n\t'TRUNCATE',\n\t'UNARCHIVE',\n\t'UNBOUNDED',\n\t'UNCACHE',\n\t'UNIQUE',\n\t'UNKNOWN',\n\t'UNLOCK',\n\t'UNSET',\n\t'USE',\n\t'USER',\n\t'USING',\n\t'VIEW',\n\t'WINDOW',\n\t'YEAR',\n\t// other\n\t'ANALYSE',\n\t'ARRAY_ZIP',\n\t'COALESCE',\n\t'CONTAINS',\n\t'CONVERT',\n\t'CURRENT ROW',\n\t'DAYS',\n\t'DAY_HOUR',\n\t'DAY_MINUTE',\n\t'DAY_SECOND',\n\t'DECODE',\n\t'DEFAULT',\n\t'DISTINCTROW',\n\t'ENCODE',\n\t'EXPLODE',\n\t'EXPLODE_OUTER',\n\t'FIXED',\n\t'GREATEST',\n\t'GROUP_CONCAT',\n\t'HOURS',\n\t'HOUR_MINUTE',\n\t'HOUR_SECOND',\n\t'IFNULL',\n\t'LEAST',\n\t'LEVEL',\n\t'MINUTE_SECOND',\n\t'NULLIF',\n\t'OFFSET',\n\t'ON DELETE',\n\t'ON UPDATE',\n\t'OPTIMIZE',\n\t'REGEXP',\n\t'SEPARATOR',\n\t'SIZE',\n\t'STRING',\n\t'TYPE',\n\t'TYPES',\n\t'UNSIGNED',\n\t'VARIABLES',\n\t'YEAR_MONTH',\n];\n\n/**\n * Priority 1 (first)\n * keywords that begin a new statement\n * will begin new indented block\n */\n// http://spark.apache.org/docs/latest/sql-ref-syntax.html\nconst reservedCommands = [\n\t// DDL\n\t'ALTER COLUMN',\n\t'ALTER DATABASE',\n\t'ALTER TABLE',\n\t'ALTER VIEW',\n\t'CREATE DATABASE',\n\t'CREATE FUNCTION',\n\t'CREATE TABLE',\n\t'CREATE VIEW',\n\t'DROP DATABASE',\n\t'DROP FUNCTION',\n\t'DROP TABLE',\n\t'DROP VIEW',\n\t'REPAIR TABLE',\n\t'TRUNCATE TABLE',\n\t'USE DATABASE',\n\t// DML\n\t'INSERT INTO',\n\t'INSERT OVERWRITE',\n\t'INSERT OVERWRITE DIRECTORY',\n\t'LOAD',\n\t// Data Retrieval\n\t'SELECT',\n\t'WITH',\n\t'CLUSTER BY',\n\t'DISTRIBUTE BY',\n\t'PARTITION BY', // verify\n\t'GROUP BY',\n\t'HAVING',\n\t'VALUES',\n\t'LIMIT',\n\t'OFFSET',\n\t'ORDER BY',\n\t'SORT BY',\n\t'TABLESAMPLE',\n\t'WHERE',\n\t'PIVOT',\n\t'TRANSFORM',\n\t'EXPLAIN',\n\t// Auxiliary\n\t'ADD FILE',\n\t'ADD JAR',\n\t'ANALYZE TABLE',\n\t'CACHE TABLE',\n\t'CLEAR CACHE',\n\t'DESCRIBE DATABASE',\n\t'DESCRIBE FUNCTION',\n\t'DESCRIBE QUERY',\n\t'DESCRIBE TABLE',\n\t'LIST FILE',\n\t'LIST JAR',\n\t'REFRESH',\n\t'REFRESH TABLE',\n\t'REFRESH FUNCTION',\n\t'RESET',\n\t'SET',\n\t'SET SCHEMA', // verify\n\t'SHOW COLUMNS',\n\t'SHOW CREATE TABLE',\n\t'SHOW DATABASES',\n\t'SHOW FUNCTIONS',\n\t'SHOW PARTITIONS',\n\t'SHOW TABLE EXTENDED',\n\t'SHOW TABLES',\n\t'SHOW TBLPROPERTIES',\n\t'SHOW VIEWS',\n\t'UNCACHE TABLE',\n\t// other\n\t'FROM',\n\t'INSERT',\n\t'UPDATE',\n\t'WINDOW', // verify\n];\n\n/**\n * Priority 2\n * commands that operate on two tables or subqueries\n * two main categories: joins and boolean set operators\n */\nconst reservedBinaryCommands = [\n\t// set booleans\n\t'INTERSECT',\n\t'INTERSECT ALL',\n\t'INTERSECT DISTINCT',\n\t'UNION',\n\t'UNION ALL',\n\t'UNION DISTINCT',\n\t'EXCEPT',\n\t'EXCEPT ALL',\n\t'EXCEPT DISTINCT',\n\t'MINUS',\n\t'MINUS ALL',\n\t'MINUS DISTINCT',\n\t// joins\n\t'JOIN',\n\t'INNER JOIN',\n\t'LEFT JOIN',\n\t'LEFT OUTER JOIN',\n\t'RIGHT JOIN',\n\t'RIGHT OUTER JOIN',\n\t'FULL JOIN',\n\t'FULL OUTER JOIN',\n\t'CROSS JOIN',\n\t'NATURAL JOIN',\n\t// apply\n\t'CROSS APPLY',\n\t'OUTER APPLY',\n\t// non-standard-joins\n\t'ANTI JOIN',\n\t'SEMI JOIN',\n\t'LEFT ANTI JOIN',\n\t'LEFT SEMI JOIN',\n\t'RIGHT OUTER JOIN',\n\t'RIGHT SEMI JOIN',\n\t'NATURAL ANTI JOIN',\n\t'NATURAL FULL OUTER JOIN',\n\t'NATURAL INNER JOIN',\n\t'NATURAL LEFT ANTI JOIN',\n\t'NATURAL LEFT OUTER JOIN',\n\t'NATURAL LEFT SEMI JOIN',\n\t'NATURAL OUTER JOIN',\n\t'NATURAL RIGHT OUTER JOIN',\n\t'NATURAL RIGHT SEMI JOIN',\n\t'NATURAL SEMI JOIN',\n\t'CROSS APPLY',\n\t'OUTER APPLY',\n];\n\n/**\n * Priority 3\n * keywords that follow a previous Statement, must be attached to subsequent data\n * can be fully inline or on newline with optional indent\n */\nconst reservedDependentClauses = ['ON', 'WHEN', 'THEN', 'ELSE', 'LATERAL VIEW'];\n\n// http://spark.apache.org/docs/latest/sql-programming-guide.html\nexport default class SparkSqlFormatter extends Formatter {\n\tstatic reservedCommands = reservedCommands;\n\tstatic reservedBinaryCommands = reservedBinaryCommands;\n\tstatic reservedDependentClauses = reservedDependentClauses;\n\tstatic reservedLogicalOperators = ['AND', 'OR', 'XOR'];\n\tstatic reservedKeywords = dedupe([\n\t\t...Object.values(reservedFunctions).reduce((acc, arr) => [...acc, ...arr], []),\n\t\t...reservedKeywords,\n\t]);\n\tstatic stringTypes: StringPatternType[] = [`\"\"`, \"''\", '``', '{}'];\n\tstatic blockStart = ['(', 'CASE'];\n\tstatic blockEnd = [')', 'END'];\n\tstatic indexedPlaceholderTypes = ['?'];\n\tstatic namedPlaceholderTypes = ['$'];\n\tstatic lineCommentTypes = ['--'];\n\tstatic operators = ['<=>', '&&', '||', '==', '->'];\n\n\ttokenizer() {\n\t\treturn new Tokenizer({\n\t\t\treservedCommands: SparkSqlFormatter.reservedCommands,\n\t\t\treservedBinaryCommands: SparkSqlFormatter.reservedBinaryCommands,\n\t\t\treservedDependentClauses: SparkSqlFormatter.reservedDependentClauses,\n\t\t\treservedLogicalOperators: SparkSqlFormatter.reservedLogicalOperators,\n\t\t\treservedKeywords: SparkSqlFormatter.reservedKeywords,\n\t\t\tstringTypes: SparkSqlFormatter.stringTypes,\n\t\t\tblockStart: SparkSqlFormatter.blockStart,\n\t\t\tblockEnd: SparkSqlFormatter.blockEnd,\n\t\t\tindexedPlaceholderTypes: SparkSqlFormatter.indexedPlaceholderTypes,\n\t\t\tnamedPlaceholderTypes: SparkSqlFormatter.namedPlaceholderTypes,\n\t\t\tlineCommentTypes: SparkSqlFormatter.lineCommentTypes,\n\t\t\toperators: SparkSqlFormatter.operators,\n\t\t});\n\t}\n\n\ttokenOverride(token: Token) {\n\t\t// [WINDOW](...)\n\t\tif (isToken.WINDOW(token) && this.tokenLookAhead()?.type === TokenType.BLOCK_START) {\n\t\t\t// This is a function call, treat it as a reserved word\n\t\t\treturn { type: TokenType.RESERVED_KEYWORD, value: token.value };\n\t\t}\n\n\t\t// .[END]\n\t\tif (isToken.END(token) && this.tokenLookBehind()?.value === '.') {\n\t\t\t// This is window().end (or similar) not CASE ... END\n\t\t\treturn { type: TokenType.WORD, value: token.value };\n\t\t}\n\n\t\t// TODO: deprecate this once ITEMS is merged with COLLECTION\n\t\tif (/ITEMS/i.test(token.value) && token.type === TokenType.RESERVED_KEYWORD) {\n\t\t\tif (\n\t\t\t\t!(\n\t\t\t\t\t/COLLECTION/i.test(this.tokenLookBehind()?.value) &&\n\t\t\t\t\t/TERMINATED/i.test(this.tokenLookAhead()?.value)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// this is a word and not COLLECTION ITEMS\n\t\t\t\treturn { type: TokenType.WORD, value: token.value };\n\t\t\t}\n\t\t}\n\n\t\treturn token;\n\t}\n}\n"],"file":"sparksql.formatter.js"}